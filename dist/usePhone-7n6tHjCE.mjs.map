{"version":3,"file":"usePhone-7n6tHjCE.mjs","names":[],"sources":["../src/composables/usePhone.ts"],"sourcesContent":["import { computed, ref, watch } from 'vue'\n\nimport { normalisePhone } from '../utils/phone/normalisePhone'\nimport type { PhoneNormResult, UsePhoneOptions } from '../utils/phone/types'\n\n/**\n * Vue composable that wraps normalisePhone() with handy refs/computed state.\n *\n * Provides reactive phone number processing with automatic normalization, validation,\n * and optional auto-formatting. Returns reactive references and helper functions\n * to manage phone input state.\n *\n * @param {string} initial - Initial phone value (default: '')\n * @param {UsePhoneOptions} opts - Configuration options\n * @returns {object} Phone composable interface\n * @returns {Ref<string>} returns.value - Reactive phone input value\n * @returns {ComputedRef<string | null>} returns.phone - normalised phone number\n * @returns {ComputedRef<boolean>} returns.valid - Whether the phone number is valid\n * @returns {ComputedRef<string[]>} returns.changes - List of changes made during normalization\n * @returns {ComputedRef<PhoneNormResult>} returns.result - Full normalization result\n * @returns {Function} returns.apply - Apply normalised phone to the input value\n * @returns {Function} returns.validate - Manually trigger validation\n */\nexport function usePhone(initial = '', opts: UsePhoneOptions = {}) {\n  opts.autoFormat = opts.autoFormat ?? false\n\n  const isValid = ref(true)\n  const value = ref<string>(initial)\n  const result = computed<PhoneNormResult>(() =>\n    normalisePhone(value.value, opts)\n  )\n  const phone = computed(() => result.value.phone)\n  const valid = computed(() => isValid.value && result.value.valid)\n  const changes = computed(() => result.value.changes)\n\n  /** Applies the formatted number back into the bound input ref. */\n  function apply() {\n    if (phone.value && value.value !== phone.value) {\n      value.value = phone.value\n    }\n  }\n\n  /** Re-runs normalisePhone() and caches the latest validity. */\n  function validate(): boolean {\n    const next = normalisePhone(value.value, opts)\n    isValid.value = next.valid\n\n    return isValid.value\n  }\n\n  watch(result, (nv) => {\n    isValid.value = nv.valid\n  })\n\n  watch(value, (nv) => {\n    if (opts.autoFormat && phone.value && nv !== phone.value) {\n      value.value = phone.value\n    }\n  })\n\n  return {\n    value,\n    phone,\n    valid,\n    changes,\n    apply,\n    validate,\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAuBA,SAAgB,SAAS,UAAU,IAAI,OAAwB,EAAE,EAAE;AACjE,MAAK,aAAa,KAAK,cAAc;CAErC,MAAM,UAAU,IAAI,KAAK;CACzB,MAAM,QAAQ,IAAY,QAAQ;CAClC,MAAM,SAAS,eACb,eAAe,MAAM,OAAO,KAAK,CAClC;CACD,MAAM,QAAQ,eAAe,OAAO,MAAM,MAAM;CAChD,MAAM,QAAQ,eAAe,QAAQ,SAAS,OAAO,MAAM,MAAM;CACjE,MAAM,UAAU,eAAe,OAAO,MAAM,QAAQ;;CAGpD,SAAS,QAAQ;AACf,MAAI,MAAM,SAAS,MAAM,UAAU,MAAM,MACvC,OAAM,QAAQ,MAAM;;;CAKxB,SAAS,WAAoB;AAE3B,UAAQ,QADK,eAAe,MAAM,OAAO,KAAK,CACzB;AAErB,SAAO,QAAQ;;AAGjB,OAAM,SAAS,OAAO;AACpB,UAAQ,QAAQ,GAAG;GACnB;AAEF,OAAM,QAAQ,OAAO;AACnB,MAAI,KAAK,cAAc,MAAM,SAAS,OAAO,MAAM,MACjD,OAAM,QAAQ,MAAM;GAEtB;AAEF,QAAO;EACL;EACA;EACA;EACA;EACA;EACA;EACD"}